<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorator="layout">
<head>
    <title>최근 검색내역</title>
</head>
<body>
<h1 layout:fragment="header">최근 검색내역</h1>
<div layout:fragment="content" class="container">
    <div class="panel-body">
        <table class="table table-bordered table-striped table-hover table-condensed">
            <thead>
            <tr>
                <td class="span1">순번</td>
                <td class="span4">검색어</td>
                <td class="span2">날짜</td>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${histories.empty}">
                <td colspan="3">검색한 내역이 없습니다.</td>
            </tr>
            <tr th:each="history, index : ${histories}">
                <td th:text="${index.index + 1 + (pageable.getPageNumber() * pageable.getPageSize())}"></td>
                <td th:text="${history.searchKeyword}"></td>
                <td th:text="${history.formattedSearchDate}"></td>
            </tr>
            </tbody>
        </table>
        <div class="pagination pagination-centered">
            <ul>
                <li th:if="${pagingInfo.isPreviousVisible()}"><a th:href="${pagingInfo.startPage} - 1">&laquo;</a></li>
                <li th:classappend="${p.isCurrentPage()} ? 'active' : '' " th:each="p:${pagingInfo.getPageElements()}">
                    <a th:href="${p.pageNumber}" th:text="${p.pageNumber}"></a></li>
                <li th:if="${pagingInfo.isNextVisible()}"><a th:href="${pagingInfo.endPage} + 1">&raquo;</a></li>
            </ul>
        </div>
    </div>
    <form id='pagingForm' th:action="@{/history}" method="get">
        <input type='hidden' name='page' th:value="${pageable.getPageNumber() + 1}" />
        <input type='hidden' name='size' th:value="${pageable.getPageSize()}" />
    </form>
</div>
</body>
<th:block layout:fragment="script">
    <script th:inline="javascript">
        $(document).ready(function() {
            var pagingForm = $("#pagingForm");

            $(".pagination a").click(function (e) {
                e.preventDefault();
                pagingForm.find('[name="page"]').val($(this).attr('href'));
                pagingForm.submit();
            });
        });
    </script>
</th:block>
</html>